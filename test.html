<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css">
        <style>
        #map {
            width: 100%;
            height: 500px;
        }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    </body>
</html>
 
<script>
  function jsonCallbackCFI(data){
    handleResponse(data, 'cfi')
  }
  function jsonCallbackCFR(data){
    handleResponse(data, 'cfr')
  }

</script>

<script>




  function handleResponse(data, key){
    console.log(data, key)
  }


    let map = L.map('map', {
        center: [12.5657, 104.991],
        zoom: 7
    });
 
    let osm = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
 
    let baseMaps = {
        "Open Street Map": osm,
    }
 
    let overlayMaps = {
 
    }
 
    document.addEventListener('DOMContentLoaded', function(){
      const cfiGeoserver = "https://staging.fia.db.opendevcam.net/geoserver/cfi/wms";
      $(document).ready(function(){
        $.ajax(cfiGeoserver,{
            type: 'GET',
            data: {
                service: 'WFS',
                version: '1.1.0',
                request: 'GetFeature',
                typename: 'cfi:cfi',
                srsname: 'EPSG:4326',
                outputFormat: 'text/javascript',
                },
            dataType: 'jsonp',
            jsonp:'format_options',
            jsonpCallback: function(data){ 
              console.log(data,'here')
              handleJson(data, 'cfi');
            },
        });
      })
 
    })
    // let cfi_effectivenes_assessment = $.ajax(cfiGeoserver, {
    //     type: 'GET',
    //     data: {
    //         service: 'WFS',
    //         version: '1.1.0',
    //         request: 'GetFeature',
    //         typename: 'cfi:Effectiveness_Assessment_2022',
    //         // CQL_FILTER: "province_en='Kampong Chhnang'",
    //         srsname: 'EPSG:4326',
    //         outputFormat: 'text/javascript',
    //     },
    //     dataType: 'json',
    //     success: (data) => {console.log('sdfsfsf')},
    // });
 
    function handleJson(data, key) {
        console.log(data, key);
        // overlayMapss[key] = L.geoJson(data);
    }
 
    // console.log(overlayMaps);
 
    // L.control.layers(baseMaps, overlayMaps).addTo(map);
 
</script>